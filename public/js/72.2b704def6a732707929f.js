(window.webpackJsonp=window.webpackJsonp||[]).push([[72],{"04tD":function(t,e,a){"use strict";a.r(e);var s=a("JspL"),l=a("9EAu"),n=a("c8RX"),i=a("ilaN"),u=function(t,e,a,s){return new(a||(a=Promise))((function(l,n){function i(t){try{r(s.next(t))}catch(t){n(t)}}function u(t){try{r(s.throw(t))}catch(t){n(t)}}function r(t){var e;t.done?l(t.value):(e=t.value,e instanceof a?e:new a((function(t){t(e)}))).then(i,u)}r((s=s.apply(t,e||[])).next())}))},r=s.a.extend({components:{FormBase:()=>a.e(12).then(a.bind(null,"qTjX")),RuleGroup:()=>a.e(13).then(a.bind(null,"316D")),SoundBar:()=>a.e(2).then(a.bind(null,"yt5i")),Btn:()=>a.e(0).then(a.bind(null,"i0GK"))},props:{playlist:{required:!0,type:Object}},data:()=>({meta:{loading:!1},mutatedPlaylist:null}),methods:{addGroup(){this.mutatedPlaylist.rules.push(this.createGroup())},onGroupChanged(t){const e=Object.assign(this.mutatedPlaylist.rules.find(e=>e.id===t.id),t);0===e.rules.length&&(this.mutatedPlaylist.rules=this.mutatedPlaylist.rules.filter(t=>t.id!==e.id))},close(){this.$emit("close")},maybeClose(){Object(l.isEqual)(this.playlist,this.mutatedPlaylist)?this.close():i.b.confirm("Discard all changes?",()=>this.close())},submit(){return u(this,void 0,void 0,(function*(){this.meta.loading=!0,yield n.e.update(this.mutatedPlaylist),Object.assign(this.playlist,this.mutatedPlaylist),this.meta.loading=!1,this.close(),yield n.e.fetchSongs(this.playlist)}))},createGroup:()=>n.e.createEmptySmartPlaylistRuleGroup()},created(){this.mutatedPlaylist=Object(l.cloneDeep)(this.playlist)}}),o=a("KHd+"),d=Object(o.a)(r,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("form-base",[a("div",{on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.maybeClose(e)}}},[t.meta.loading?a("sound-bar"):a("form",{attrs:{"data-testid":"edit-smart-playlist-form"},on:{submit:function(e){return e.preventDefault(),t.submit(e)}}},[a("header",[a("h1",[t._v("Edit Smart Playlist")])]),t._v(" "),a("div",[a("div",{staticClass:"form-row"},[a("label",[t._v("Name")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.mutatedPlaylist.name,expression:"mutatedPlaylist.name"},{name:"koel-focus",rawName:"v-koel-focus"}],attrs:{type:"text",name:"name",required:""},domProps:{value:t.mutatedPlaylist.name},on:{input:function(e){e.target.composing||t.$set(t.mutatedPlaylist,"name",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"form-row rules"},[t._l(t.mutatedPlaylist.rules,(function(e,s){return a("rule-group",{key:e.id,attrs:{isFirstGroup:0===s,group:e},on:{input:t.onGroupChanged}})})),t._v(" "),a("btn",{staticClass:"btn-add-group",attrs:{green:"",small:"",uppercase:""},on:{click:function(e){return e.preventDefault(),t.addGroup(e)}}},[a("i",{staticClass:"fa fa-plus"}),t._v(" Group\n          ")])],2)]),t._v(" "),a("footer",[a("btn",{attrs:{type:"submit"}},[t._v("Save")]),t._v(" "),a("btn",{staticClass:"btn-cancel",attrs:{white:""},on:{click:function(e){return e.preventDefault(),t.maybeClose(e)}}},[t._v("Cancel")])],1)])],1)])}),[],!1,null,null,null);e.default=d.exports}}]);